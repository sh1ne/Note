# Note App - Project Plan

## Overview
A web-based note-taking application similar to Evernote that works on iPhone and can be saved to the home screen as a Progressive Web App (PWA).

## Technology Stack

**Frontend:**
- **Next.js 14** (App Router) - React framework with PWA support
- **TypeScript** - Type safety and better code quality
- **Tailwind CSS** - Modern, responsive styling
- **TipTap** - Full-featured rich text editor

**Backend:**
- **Firebase** - Authentication, database, and file storage
  - Firestore (database)
  - Firebase Storage (images)
  - Firebase Auth (email/password)

**Hosting:**
- **Vercel** - Free hosting with automatic deployments

**Why This Stack:**
- âœ… Unlimited Firebase projects (perfect for multiple apps)
- âœ… Free tier is generous (1GB storage, 50K reads/day, 20K writes/day)
- âœ… Zero server maintenance
- âœ… Perfect for PWAs
- âœ… $0/month cost

## Core Features

### Rich Text Editor (TipTap)
**Text Formatting:**
- Bold, Italic, Underline, Strikethrough
- Text alignment (left, center, right, justify)
- Font size (small, normal, large, headings)
- Text color & highlight color
- Subscript & Superscript

**Lists & Organization:**
- Bullet points (unordered lists)
- Numbered lists (ordered lists)
- Nested lists (indented lists)
- Checkboxes/task lists
- Blockquotes

**Content:**
- Images (upload from phone camera/gallery, resize, align)
- Links (create, edit, remove)
- Horizontal rules/dividers
- Code blocks (with syntax highlighting)
- Tables (insert, edit, delete rows/columns)

**Editing:**
- Undo/Redo
- Copy/Paste with formatting
- Mobile-friendly toolbar

### Bottom Navigation & Tab System

**Default Tabs:**
1. **Tab 1 - "Scratch"** (default tab) - Icon: Pencil/Notepad
2. **Tab 2 - "Now"** - Icon: Clock/Urgency
3. **Tab 3 - "Short-Term"** - Icon: Calendar Near
4. **Tab 4 - "Long-term"** - Icon: Calendar Far
5. **Tab 5 - "All Notes"** - Icon: List/Document
6. **Tab 6 - "More"** - Icon: Three dots "..."

**Bottom Navigation Bar (Left to Right):**
1. **Plus Button** - Create new note (creates note that appears in new tab)
2. **Tab 1** - "Scratch" (icon + text)
3. **Tab 2** - "Now" (icon + text)
4. **Tab 3** - "Short-Term" (icon + text)
5. **Tab 4** - "Long-term" (icon + text)
6. **Tab 5** - "All Notes" (icon + text)
7. **Tab 6** - "More" (icon: "...", text: "More")

**Tab Features:**
- All tabs are **renamable**
- **Staple Tabs** (Scratch, Now, Short-Term, Long-term):
  - Cannot be deleted (always exist)
  - Can be renamed
  - Can be reordered (when unlocked, can drag to rearrange)
- **Dynamic Tabs**: Plus button creates new NOTE that appears in a new tab (to the left of Scratch tab)
- Tabs can be **locked or unlocked** (global toggle - all locked or all unlocked)
  - **Locked by default**
  - **Locked tabs**: Notes cannot be moved between tabs, tabs cannot be deleted/reordered
  - **Unlocked tabs**: Notes can be moved between tabs, tabs can be added/deleted/reordered
- **Tab Options Menu** (when clicking unlocked tab):
  - Rename tab
  - Delete tab (not available for staple tabs)
  - Change icon
  - Change color

### Note Creation
- **Plus Button** - Creates a new NOTE that appears in a new tab (to the left of Scratch tab)
- The new tab is created to display the new note
- Note title: Auto-generated from first line of content
- New note opens immediately in editor
- Note is saved to "All Notes" automatically
- Auto-saves as you type (see Auto-Save Strategy below)

### "All Notes" Tab (Tab 5)
- Shows all notes in current notebook
- List of notes with title + preview + date updated
- Click note â†’ opens in editor for viewing/editing
- Shows all notes regardless of which tab they're in
- New notes created with Plus button automatically appear here
- Can filter/search within this view

### Note Editor Header Bar
**Left Side:**
- Back Button - Return to note list
- Undo Button - Undo last action
- Redo Button - Redo last action

**Right Side:**
- Share Button - Opens menu with options:
  - Export note (PDF, Markdown, etc.)
  - Email note
  - Screenshot note and save to phone
  - Copy link to note
- Find Button - Opens search bar
  - Search current note OR all notes (toggle option)
  - Search for specific words

### Note Deletion
- **Confirmation Window**: Shows confirmation popup before deleting
- **Goes to Trash**: Deleted notes go to Trash immediately
- **Trash Management**: 
  - Can permanently delete individual notes from Trash
  - Can permanently delete ALL notes from Trash
  - Can restore notes from Trash
  - Auto-delete after 30 days if not restored

### Notebook System
- **Notebooks**: Each notebook is a separate instance/workspace
- **Create New Notebook**: Creates blank new instance (all tabs empty)
- **Default Notebook**: Created automatically on first login (with 6 default tabs)
- **Switch Between Notebooks**: Access from "More" tab
- **Only One Notebook Active**: You're only in one notebook at a time
- **Auto-Save**: Everything auto-saves continuously, and when switching notebooks
- **All Data Housed in Notebook**: Notes, tabs, settings per notebook
- **Notebook Naming**: Can be renamed to whatever user wants (custom names)
- **No Tutorial**: No onboarding/tutorial on first use

### Theme System
**Theme Options:**
- Dark Theme (black background)
- Light Theme (white background)
- Purple Theme
- Blue Theme
- User can switch between themes

### "More" Tab (Tab 6)
**Core Features:**
- Account/Profile info
- Theme Selection (Dark/Light/Purple/Blue)
- Export Notes
- Force Update to Cloud
- Notebook Management (create, switch, rename, delete)
- Tab Lock/Unlock Toggle (global - locks/unlocks all tabs)
- Storage Usage (see how much Firebase storage used)
- Sync Status (last sync time, sync indicator)
- Search All Notes (global search across all notebooks)
- Export All Data (backup all notebooks)
- Trash/Deleted Notes (restore deleted notes - 30 day retention)
- Settings (auto-save, default notebook/tab, font size)
- About/Help (app info, tutorial)

## Auto-Save Strategy

**Two-Tier Saving System:**

1. **Local Save (Immediate)**
   - Save to browser's IndexedDB (local storage) instantly
   - No network calls = no lag, no cost
   - Works offline
   - User never loses work

2. **Cloud Sync (Debounced)**
   - Sync to Firebase every **2-3 seconds** after user stops typing
   - OR sync immediately when user switches tabs/notebooks
   - Uses Firebase writes (counts toward free tier)

**Why This Approach:**
- âœ… No lag: Local save is instant
- âœ… Cost efficient: Debounced sync = fewer Firebase writes
- âœ… Offline support: Works without internet
- âœ… Data safety: Local + cloud backup
- âœ… Free tier friendly: 20K writes/day is plenty for personal use

**Implementation:**
- Typing â†’ Save locally immediately
- Stop typing for 2-3 seconds â†’ Sync to Firebase
- Switch tab/notebook â†’ Force sync immediately
- Offline â†’ Queue syncs, execute when online

## Database Schema

```typescript
// Notebooks structure (Firestore)
notebooks: {
  id: string
  userId: string
  name: string
  createdAt: timestamp
  updatedAt: timestamp
  isDefault: boolean
}

// Tabs structure (Firestore) - stored per notebook
tabs: {
  id: string
  notebookId: string
  name: string
  icon: string (icon name or emoji)
  order: number (position in bottom nav)
  isLocked: boolean
  isStaple: boolean (for 4 staple tabs)
  createdAt: timestamp
}

// Notes structure (Firestore)
notes: {
  id: string
  userId: string
  notebookId: string
  tabId: string (which tab the note belongs to)
  title: string
  content: string (HTML from TipTap)
  contentPlain: string (for search)
  images: string[] (Firebase Storage URLs)
  createdAt: timestamp
  updatedAt: timestamp
  isArchived: boolean
  deletedAt: timestamp | null (for trash)
}

// User preferences
userPreferences: {
  userId: string
  currentNotebookId: string
  theme: 'dark' | 'light' | 'purple' | 'blue'
  autoSave: boolean
  autoSaveInterval: number (seconds)
  tabsLocked: boolean
}
```

## Project Structure

```
note/
â”œâ”€â”€ .next/                    # Next.js build files (auto-generated)
â”œâ”€â”€ public/                   # Static files (icons, images)
â”‚   â”œâ”€â”€ icons/               # PWA icons
â”‚   â””â”€â”€ manifest.json        # PWA manifest
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                 # Next.js app directory (routing)
â”‚   â”‚   â”œâ”€â”€ (auth)/         # Auth pages (login, signup)
â”‚   â”‚   â”œâ”€â”€ (dashboard)/    # Main app pages
â”‚   â”‚   â””â”€â”€ layout.tsx      # Root layout
â”‚   â”œâ”€â”€ components/          # Reusable React components
â”‚   â”‚   â”œâ”€â”€ editor/         # Rich text editor components
â”‚   â”‚   â”œâ”€â”€ notes/          # Note-related components
â”‚   â”‚   â”œâ”€â”€ ui/             # Basic UI components (buttons, etc.)
â”‚   â”‚   â””â”€â”€ layout/         # Layout components (header, nav)
â”‚   â”œâ”€â”€ lib/                 # Utilities & configurations
â”‚   â”‚   â”œâ”€â”€ firebase/       # Firebase config & helpers
â”‚   â”‚   â”œâ”€â”€ utils/          # Helper functions
â”‚   â”‚   â””â”€â”€ types/          # TypeScript types
â”‚   â”œâ”€â”€ hooks/               # Custom React hooks
â”‚   â”œâ”€â”€ contexts/            # React contexts (auth, theme)
â”‚   â””â”€â”€ styles/              # Global styles, Tailwind config
â”œâ”€â”€ .env.local               # Environment variables (not in git)
â”œâ”€â”€ .gitignore               # Git ignore rules
â”œâ”€â”€ package.json             # Dependencies
â”œâ”€â”€ tsconfig.json            # TypeScript config
â”œâ”€â”€ tailwind.config.js       # Tailwind CSS config
â””â”€â”€ README.md                # Project documentation
```

## Development Phases

### Phase 1: Core Foundation
1. Project Setup (Next.js, TypeScript, Tailwind)
2. Firebase Configuration
3. Authentication (Sign up/Login)
4. Database Structure
5. Basic Note CRUD
6. Rich Text Editor (TipTap)
7. UI Foundation (Dark mode, mobile-responsive)

### Phase 2: Core Features
1. Image Upload (camera/gallery)
2. Tab System (bottom navigation, tabs management)
3. Notebook System
4. PWA Setup (manifest, service worker, offline support)
5. Cloud Sync (real-time sync)
6. Auto-save functionality

### Phase 3: Polish & Advanced
1. Theme System (Dark/Light/Purple/Blue)
2. "More" Tab Features
3. Search Functionality
4. Export/Share Features
5. Trash Management
6. Performance Optimization

## Security

**Firebase Security Rules:**
```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /notes/{noteId} {
      allow read, write: if request.auth != null && 
        request.auth.uid == resource.data.userId;
    }
    match /notebooks/{notebookId} {
      allow read, write: if request.auth != null && 
        request.auth.uid == resource.data.userId;
    }
    match /tabs/{tabId} {
      allow read, write: if request.auth != null;
    }
  }
}
```

## Cost

- **Firebase**: Free tier (unlimited projects)
  - 1GB storage per project
  - 50K reads/day
  - 20K writes/day
  - 20K deletes/day
- **Vercel**: Free tier
  - Unlimited projects
  - 100GB bandwidth/month
- **Total**: $0/month

## Maintenance

**What You WON'T Need to Maintain:**
- Firebase (Google maintains it)
- Vercel (They handle infrastructure)
- Hosting (Fully managed)
- Database (Firebase handles backups)

**What You MIGHT Want to Update (Optional):**
- Dependencies (npm packages) - Every few months
- Next.js/Framework Updates - Every 6-12 months (or never)
- Feature Additions - Only if you want new features

**Realistic Maintenance:**
- Year 1: Probably zero maintenance needed
- Year 2+: Maybe update dependencies once (if you want)
- Security updates: Only if critical (Firebase/Vercel handle most)

---

**Status**: Ready to build! ðŸš€
